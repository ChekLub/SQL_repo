# SQL_repo
задачи на SQL

# SQL_dfct_phone
Краткое описание:
Есть таблица глобальных клиентов (физ и юр лиц).
Есть таблица связи по ID глобальных клиентов и локальных клиентов (из других систем источников).
Есть таблица контактов клиентов (локальных и глобальных), представляющая собой хранилище, то есть исторический срез.
Необходимо:
  1) Разработать SQL-скрипт построения объекта-приёмника, в котором будет содержаться история изменения телефонов глобальных клиентов с учетом их связи с локальными ID клиентов
  2) Провести дедупликацию телефонов
  3) Определить лучший номер телефона для клиента
  4) Описать алгоритм построения объекта-приёмника в формате ТИС (Требования к Информационной Системе)
  5) Сформировать маппинг построения объекта в формате карты отображения.

Задача выполняется в синтаксисе СУБД PostgreSQL с использованием: 
- представлений,
- оконных функций с партиционированием,
- соединений таблиц join.

## Задание и описание таблиц в ходе решения.odt 
- файл с подробным описанием задачи и таблиц, получаемых в ходе решения.
## dfct_phone_all_ddl.sql 
- ddl скрипты для наполнения исходных таблиц с клиентами и номерами телефонов.
## SQL скрипт для dfct_phone.txt 
- скрипт для выполнения основной задачи.
## dfct_phone_карта отображения.xlsx 
- карта отображения s2t.

# Calendar_curr_SQL.txt
Задача: 
Существует таблица котировок финансовых инструментов Rate. Записи в таблицу добавляются в день смены курса (не каждый день).  Курс действует с даты установки по дату следующей установки (не включительно).
Необходимо сгенерировать календарь Calendar по рабочим дням за период c 05.06.2009 по 18.06.2009.
Вывести значение курса по каждой валюте за каждый день периода с c 05.06.2009 по 18.06.2009 по каждой валюте.

Задача решена в синтаксисе СУБД PostgreSQL с применением:
- генератора дат, 
- оконных функций,
- соединений таблиц join.

create table Rate( id int not null, code varchar(50) not null, date datetime not null, value float not null )
Дата в поле date хранится без времени.
Схема действия курса: insert into rate (id, code, date, value) values (1,'EUR','20090605', 1.149) insert into rate (id, code, date, value) values (2,'EUR','20090615', 1.161) insert into rate (id, code, date, value) values (3,'EUR','20090617', 1.177) insert into rate (id, code, date, value) values (4,'USD','20090605', 1.625) insert into rate (id, code, date, value) values (5,'USD','20090615', 1.639) insert into rate (id, code, date, value) values (6,'USD','20090617', 1.644)

Ожидаемый результат: EUR 2009-06-05 1.149 Friday EUR 2009-06-08 1.149 Monday EUR 2009-06-09 1.149 Tuesday EUR 2009-06-10 1.149 Wednesday EUR 2009-06-11 1.149 Thursday EUR 2009-06-15 1.161 Monday EUR 2009-06-16 1.161 Tuesday EUR 2009-06-17 1.177 Wednesday EUR 2009-06-18 1.177 Thursday USD 2009-06-05 1.625 Friday USD 2009-06-08 1.625 Monday USD 2009-06-09 1.625 Tuesday USD 2009-06-10 1.625 Wednesday USD 2009-06-11 1.625 Thursday USD 2009-06-15 1.639 Monday USD 2009-06-16 1.639 Tuesday USD 2009-06-17 1.644 Wednesday USD 2009-06-18 1.644 Thursday

